# Monitoring Kubernetes with NewRelic

- New Relic's Kubernetes integration instruments the container orchestration layer by reporting metrics from Kubernetes objects. The integration gives you insight into your Kubernetes nodes, namespaces, deployments, replica sets, pods, and containers. 

- Features include:

  - View your data in pre-built dashboards for immediate insight into your Kubernetes environment.
  - Create your own custom queries and charts in Insights from automatically reported data.
  - Create alert conditions on Kubernetes data.

---

## Set up NewRelic Integration

- Install [kube-state-metrics](https://github.com/kubernetes/kube-state-metrics#kubernetes-deployment) and get it running on the cluster. 
.small[
  ```bash
  curl -o kube-state-metrics-1.3.zip https://codeload.github.com/kubernetes/kube-state-metrics/zip/release-1.3 && unzip kube-state-metrics-1.3.zip && kubectl apply -f kube-state-metrics-release-1.3/kubernetes
  ```
]
- Download the integration configuration file:
.small[
  ```bash
  curl -O https://download.newrelic.com/infrastructure_agent/integrations/kubernetes/newrelic-infrastructure-k8s-latest.yaml
  ```
]
- In the configuration file, add your New Relic license key and a cluster name to identify your Kubernetes cluster.
.small[
  ```yaml
    env:
      - name: NRIA_LICENSE_KEY
        value: YOUR_LICENSE_KEY
      - name: CLUSTER_NAME
        value: YOUR_CLUSTER_NAME
  ```]

---

## Set up NewRelic Integration

- Confirm that kube-state-metrics is installed.
.small[
  ```bash
kubectl get pods --all-namespaces | grep kube-state-metrics
```]
- Create the daemon set:
.small[
  ```bash
kubectl create -f newrelic-infrastructure-k8s-latest.yaml
```]
- Confirm that the daemon set has been created successfully by looking for newrelic-infra in the results generated by this command:
.small[
  ```bash
kubectl get daemonsets
```]
- To confirm that the integration has been configured correctly, wait a few minutes, then run this [New Relic Insights](https://insights.newrelic.com/)  query to see if data has been reported:
.small[
  ```bash
SELECT * FROM K8sPodSample since 1 day ago
```]

---
## Find and Use Data
- To view the Kubernetes integration's dashboard:

  - Go to [infrastructure.newrelic.com](https://infrastructure.newrelic.com/)  > Integrations > On host integrations.
  - Select the Kubernetes dashboard link to open the default Kubernetes dashboard automatically created in Insights.

For more info: [NewRelic Documentation](https://docs.newrelic.com/docs/integrations/host-integrations/host-integrations-list/kubernetes-monitoring-integration)


